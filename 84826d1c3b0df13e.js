(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[5024],{

/***/ 376699:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(813110);__web_req__(558104);self._fe4d99ebe0d2d259646a80d250150d47 = self._fe4d99ebe0d2d259646a80d250150d47 || {};(function(__c) {var zc=__c.zc;var Nc=__c.Nc;var xt=__c.xt;var P=__c.P;var bw=__c.bw;var ae=__c.ae;var lj=__c.lj;var A=__c.A;var Md=__c.Md;var D=__c.D;var O=__c.O;
var wBb=function(a){switch(a){case 4:return O("9ND0kg");case 2:return O("ibdecg");case 7:return O("446quA");case 5:return O("j1fbqg");case 1:return O("O5i4AQ");case 6:return O("C0VHsg");case 3:return O("+IXmVg");default:throw new D(a);}},xBb=function(a){return b=>({type:"react",node:(0,__c.N)(a,{...b})})},yBb=function(a){return b=>({type:"dom",render:c=>a(b,c)})},ABb=function(a){var b,c=a.zw,d=a.content;a=a.context;__c.y("formula"===(null===d||void 0===d?void 0:null===(b=d.Pg)||void 0===b?void 0:
b.type));b=d.Pg.value;switch(b.type){case "invalid":b=b.m7;break;case "canonical":b=b.cH;break;default:throw new D(b);}__c.y(b.startsWith("="));const e=d.bv;b={type:"dom",render:h=>h.innerText=""};let f;switch(e.type){case 6:f=b;break;case 1:case 3:case 4:case 2:case 5:f=zBb(c,a,d.Iu);break;case 0:f={type:"react",node:T5(__c.ST,{label:wBb(e.error),children:T5(__c.eO,{width:"full",display:"flex",justifyContent:"center",children:T5(__c.qfb,{tone:"critical"})})})};break;default:throw new D(e);}if(!f)return b;
c=Md(__c.xS,a.attrs);d=__c.pI(a.attrs.textAlign,"formula",void 0,()=>e.type);const g={textAlign:__c.lta(d,c.direction),justifyContent:__c.mta(d)};switch(f.type){case "dom":return{type:"dom",render:h=>{Object.assign(h.style,g);f.render(h)}};case "react":return{type:"react",node:T5("div",{style:g,children:f.node})};default:throw new D(f);}},zBb=function(a,b,c){var d;return null===(d=a.taa)||void 0===d?void 0:d.call(a,{context:b,value:c})},EBb=function(a){const b=a.zw,c=a.ih;a=a.U7a;b.taa=BBb;b.Oqa=
d=>ABb({...d,zw:b});b.Pqa=xBb(CBb({ih:c,wR:void 0}));b.Rqa=DBb(a);b.Sqa=xBb(U5)},FBb=function(a,b,c){const d=[a];for(;null!=a&&a!==b;)(a=c.next(a))&&d.push(a);return d},GBb=function({label:a,width:b,height:c,scale:d,highlight:e,selected:f}){return T5("div",{style:{width:b,height:c,transform:`scale(${d})`},className:"bx74uQ",children:T5(__c.jv,{className:V5({yiml1g:e,oYlhXA:f}),size:"small",alignment:"center",children:a})})},IBb=function({$c:a,highlight:b,scale:c,qv:d,Xm:e,XKa:f}){const g=W5(()=>{const m=
null===d||void 0===d?void 0:d.get();if(null!=m&&0!==m.length)return new __c.mE(m)},[d]),h=e(1),k=e(c),l={ssE9Tg:!a,OkifGQ:a};return T5(__c.kv,{ho:"light",light:"light",Iq:"light",dark:"light",children:m=>T5("div",{className:V5("ze9QCQ",l,m.className),style:{width:k,height:k},children:T5("div",{style:{width:h,height:h,transform:`scale(${c})`},className:V5("N7J3UA",l),ref:null===g||void 0===g?void 0:g.Xf,children:T5(__c.fO,{className:V5("m8CFdg",l,{G6wL4w:f,W_E0wA:b}),ariaLabel:O("ruWN9A"),children:T5(HBb,
{size:"tiny"})})})})})},KBb=function(){const a=new JBb,b=new __c.DY,c=X5(f=>{const {scale:g=1,size:h="small",XKa:k=!0}=f,l=Y5(m=>a.Xm(m,h),[h]);return T5(IBb,{...f,scale:g,$c:"rtl"===f.sheet.direction,highlight:null!=f.selection&&a.xZa(f.sheet,f.selection),Xm:l,XKa:k})}),d=X5(f=>{const {scale:g=1,size:h="small"}=f,k=Y5(n=>a.Xm(n,h),[h]),l=Y5(n=>null!=f.selection&&a.mGa(f.selection).has(n),[f.selection]),m=Y5(n=>null!=f.selection&&a.FXa(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return T5(Z5,
{...f,scale:g,Xm:k,tza:l,eHa:m,YO:b})}),e=X5(f=>{const {scale:g=1,size:h="small"}=f,k=Y5(n=>a.Xm(n,h),[h]),l=Y5(n=>null!=f.selection&&a.oGa(f.selection).has(n),[f.selection]),m=Y5(n=>null!=f.selection&&a.GXa(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return T5($5,{...f,scale:g,Xm:k,fHa:m,Pza:l,YO:b})});return{vLa:c,uLa:d,wLa:e}},LBb=function(a){const b=a.tq,c=()=>null;return __c.Wt(d=>T5(a6,{...d,tq:b,Tj:c}))},OBb=function({onScroll:a}){const b=new MBb(a);return{LF:b,caa:X5(c=>T5(NBb,{sheet:c.sheet,
LF:b,children:c.children}))}},QBb=function(a){const b=a.tq,c=a.Rd,d=a.WGa,e=({children:k})=>k,{LF:f,caa:g}=OBb({onScroll:a.onScroll});class h extends PBb{get JG(){const k=this.props.Eb.ZD;switch(k){case "screen":return g;case "print":return e;default:throw new D(k);}}componentDidMount(){d.NGa(this.props.item,{Ub:this.props.Ub,Eb:this.props.Eb,Cg:this.props.Cg})}componentWillUnmount(){d.AQa(this.props.item,{Ub:this.props.Ub,Eb:this.props.Eb,Cg:this.props.Cg})}render(){d.NGa(this.props.item,{Ub:this.props.Ub,
Eb:this.props.Eb,Cg:this.props.Cg});return T5(b6,{...this.props,scaleFactor:this.scaleFactor,tq:b,Rd:c,JG:this.JG,WGa:d})}constructor(...k){super(...k);this.scaleFactor=c6(()=>{const l=this.props.item;var m=this.props.Eb,n=m.ZD;m=m.zoom;switch(n){case "screen":return 1;case "print":n=d.XWa(l);if(!n)return 1;({width:n}=new __c.Aw(l,n.Ub,{zoom:m}));return n/l.config.width;default:throw new D(n);}})}}return{pNa:h,LF:f}},RBb=function(a,b){if(null!=b&&null!=b.Lc&&null!=b.Pc&&null!=b.Vd&&null!=b.re){var c=
a.qa(b.Lc),d=a.ra(b.Pc),e=a.qa(b.Vd)+b.Vd.width-c;a=a.ra(b.re)+b.re.height-d;return __c.gs({top:d,left:c,width:e,height:a})}},TBb=function(a){const b=a.tq,c=()=>null;return d=>T5(SBb,{...d,tq:b,Tj:c})},UBb=function(a,b,c){return a<c&&c<b},YBb=function(a,b,c,d,e){if(0===c.length||0===d.length)return[];const f=VBb(a,b,c,d,e);e=WBb(a,b,c,d,e);const g=XBb(a,b,c,d),h=a.TWa(b),k=a.rWa(b),l="rtl"===b.direction;a=f.map(m=>{var n,p,q=m.j7a,r=m.Vea,t=m.LFa;const u=m.color,w=m.weight;m=m.Tb;const x=l?-1:1,z=
null===(n=g.get(d6(q,t)))||void 0===n?void 0:n.Ja;n=null===(p=g.get(d6(r,t)))||void 0===p?void 0:p.qa;if(null!=z&&null!=n){p=A(h.get(t.xa));var B=A(k.get(q.column));q=A(k.get(r.column));t="start"===t.boundary?p.start:p.end;p=B.start;r="start"===r.boundary?q.start:q.end;return{color:u,weight:w,Tb:m,p1:new __c.Hr(p+z*x,t),p2:new __c.Hr(r+n*x,t),...__c.dw((r-p)*x,m*w,z)}}}).filter(__c.ub);return[...e.map(m=>{var n,p,q=m.Gta,r=m.o7a,t=m.Yea;const u=m.color,w=m.weight;m=m.Tb;const x=null===(n=g.get(d6(q,
r)))||void 0===n?void 0:n.Ea;n=null===(p=g.get(d6(q,t)))||void 0===p?void 0:p.ra;if(null!=x&&null!=n){p=A(k.get(q.column));var z=A(h.get(r.xa));r=A(h.get(t.xa));q="start"===q.boundary?p.start:p.end;p=z.start;t="start"===t.boundary?r.start:r.end;return{color:u,weight:w,Tb:m,p1:new __c.Hr(q,p+x),p2:new __c.Hr(q,t+n),...__c.dw(t-p,m*w,x)}}}).filter(__c.ub),...a]},ZBb=function(a){const b=[];a=a.filter(c=>0!==c.weight&&null!=c.color);a=__c.vd(a,c=>c.weight);a=Array.from(a.entries()).sort(([c],[d])=>c-
d);for(const [c,d]of a){a=__c.vd(d,e=>`${e.Si}_${e.Ti}`);for(const [,e]of a){const {Ti:f,Si:g}=e[0];a=__c.vd(e,h=>h.color);for(const [h,k]of a)b.push({weight:c,color:h,lines:k,Si:g,Ti:f})}}return b},aCb=function(a,b,c,d){var e=$Bb;b=b.flatMap(f=>a.rows.last()===f?[{xa:f,boundary:"start"},{xa:f,boundary:"end"}]:[{xa:f,boundary:"start"}]);c=c.flatMap(f=>a.cols.last()===f?[{column:f,boundary:"start"},{column:f,boundary:"end"}]:[{column:f,boundary:"start"}]);d=YBb(e,a,b,c,e.VQa(d));return ZBb(d)},VBb=
function(a,b,c,d,e){const f=[];for(const l of c)for(const m of d){c=l.xa;var g=m.column,h=lj(b.cells,g,c);if(!h||h.span.Pc===c)if(c=e6(a.oK,b,g,c,e),c="start"===l.boundary?null===c||void 0===c?void 0:c.ra:null===c||void 0===c?void 0:c.Ea){h=f[f.length-1];g=(g=b.cols.next(g))?{column:g,boundary:"start"}:{column:A(b.cols.last()),boundary:"end"};var k;if(k=h)k=h.Vea,k=k.column===m.column&&k.boundary===m.boundary;k&&(k=h.LFa,k=k.xa===l.xa&&k.boundary===l.boundary);k&&h.color===c.color&&h.weight===c.weight&&
h.Tb===c.Tb&&0===h.Tb?h.Vea=g:f.push({LFa:l,j7a:m,Vea:g,color:c.color,weight:c.weight,Tb:c.Tb})}}return f},WBb=function(a,b,c,d,e){const f=[];for(const l of d)for(const m of c){var g=m.xa;d=l.column;var h=lj(b.cells,d,g);if(!h||h.span.Lc===d)if(d=e6(a.oK,b,d,g,e),d="start"===l.boundary?null===d||void 0===d?void 0:d.qa:null===d||void 0===d?void 0:d.Ja){h=f[f.length-1];g=(g=b.rows.next(g))?{xa:g,boundary:"start"}:{xa:A(b.rows.last()),boundary:"end"};var k;if(k=h)k=h.Gta,k=k.column===l.column&&k.boundary===
l.boundary;k&&(k=h.Yea,k=k.xa===m.xa&&k.boundary===m.boundary);k&&h.color===d.color&&h.weight===d.weight&&h.Tb===d.Tb&&0===h.Tb?h.Yea=g:f.push({Gta:l,o7a:m,Yea:g,color:d.color,weight:d.weight,Tb:d.Tb})}}return f},XBb=function(a,b,c,d){const e=(p,q)=>{var r=a.oK.FRa(b);const t=r.get(p)||0;r=r.get(q)||0;return t<=r?p:q},f=new Map;if(0===c.length||0===d.length)return f;var g=[],h=b.cols.Ac(d[0].column);h&&g.push({column:h,boundary:"start"});g.push(...d);(d=b.cols.next(d[d.length-1].column))&&g.push({column:d,
boundary:"start"});d=[];(h=b.rows.Ac(c[0].xa))&&d.push({xa:h,boundary:"start"});d.push(...c);(c=b.rows.next(c[c.length-1].xa))&&d.push({xa:c,boundary:"start"});for(const p of g){c=(g="start"===p.boundary?p.column:void 0)?b.cols.Ac(g):b.cols.last();for(const q of d){var k="start"===q.boundary?q.xa:void 0;h=k?b.rows.Ac(k):b.rows.last();var l=e6(a.oK,b,g,k),m=e6(a.oK,b,g,h);k=e6(a.oK,b,c,k);var n=e6(a.oK,b,c,h);h="end"===p.boundary?null===k||void 0===k?void 0:k.Ja:null===l||void 0===l?void 0:l.qa;l=
"end"===q.boundary?null===m||void 0===m?void 0:m.Ea:null===l||void 0===l?void 0:l.ra;m="end"===p.boundary?null===n||void 0===n?void 0:n.Ja:null===m||void 0===m?void 0:m.qa;k="end"===q.boundary?null===n||void 0===n?void 0:n.Ea:null===k||void 0===k?void 0:k.ra;n=__c.aw({ra:m,Ea:h,qa:k,Ja:l},e);let r;switch(n){case "blockStart":r=m;break;case "blockEnd":r=h;break;case "inlineStart":r=k;break;case "inlineEnd":r=l;break;default:r=void 0}const {height:t,width:u}=1===(null===r||void 0===r?void 0:r.Tb)?{height:r.weight,
width:r.weight}:{height:Math.max((null===k||void 0===k?void 0:k.weight)||0,(null===l||void 0===l?void 0:l.weight)||0),width:Math.max((null===m||void 0===m?void 0:m.weight)||0,(null===h||void 0===h?void 0:h.weight)||0)};f.set(d6(p,q),__c.Yv(n,t/2,u/2))}}return f},e6=function(a,b,c,d,e){if(c&&d)return a.z5a(b,e).get(`${c.id}:${d.id}`)},bCb=function(a,b,c){var d,e=b?a.layout.attrs.get(ae({J_:void 0,R_:void 0,N_:void 0}),b.span.Pc,b.span.Lc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=
c.get(`${b.span.Lc.id}:${b.span.Pc.id}`))||void 0===d?void 0:d.Ea)||!1;d={color:a.ai.color,weight:a.ai.weight,Tb:bw(a.ai.vd)};c=f6(e.J_);var f=g6(e.R_);e=h6(e.N_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,vB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Tb:e?bw(e):d.Tb},vB:!1,hidden:b}}},cCb=function(a,b,c){var d,e=b?a.layout.attrs.get(ae({K_:void 0,S_:void 0,O_:void 0}),b.span.Pc,b.span.Lc)||{}:void 0;if(b&&e){b=(null===c||
void 0===c?void 0:null===(d=c.get(`${b.span.Lc.id}:${b.span.Pc.id}`))||void 0===d?void 0:d.ra)||!1;d={color:a.ai.color,weight:a.ai.weight,Tb:bw(a.ai.vd)};c=f6(e.K_);var f=g6(e.S_);e=h6(e.O_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,vB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Tb:e?bw(e):d.Tb},vB:!1,hidden:b}}},i6=function(a,b,c,d){if(!a.hidden&&!c.hidden){var e=a.vB?c.vB?void 0:c:a;return __c.$v(a.borderStyle,c.borderStyle,
b,d,null===e||void 0===e?void 0:e.borderStyle)}},dCb=function(a,b,c){var d,e=b?a.layout.attrs.get(ae({L_:void 0,T_:void 0,P_:void 0}),b.span.Pc,b.span.Lc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Lc.id}:${b.span.Pc.id}`))||void 0===d?void 0:d.Ja)||!1;d={color:a.ai.color,weight:a.ai.weight,Tb:bw(a.ai.vd)};c=f6(e.L_);var f=g6(e.T_);e=h6(e.P_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,vB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,
weight:null!==f&&void 0!==f?f:d.weight,Tb:e?bw(e):d.Tb},vB:!1,hidden:b}}},eCb=function(a,b,c){var d,e=b?a.layout.attrs.get(ae({M_:void 0,U_:void 0,Q_:void 0}),b.span.Pc,b.span.Lc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Lc.id}:${b.span.Pc.id}`))||void 0===d?void 0:d.qa)||!1;d={color:a.ai.color,weight:a.ai.weight,Tb:bw(a.ai.vd)};c=f6(e.M_);var f=g6(e.U_);e=h6(e.Q_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,vB:!0,hidden:b}:{borderStyle:{color:null!==
c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Tb:e?bw(e):d.Tb},vB:!1,hidden:b}}},fCb=function(a,b,c){var d=b.column,e=b.xa;if(b=lj(a.cells,d,e)){var f=d===b.span.Lc,g=d===b.span.Vd,h=e===b.span.Pc,k=e===b.span.re;if(f||g||h||k){var l=a.rows.Ac(e),m=l?lj(a.cells,d,l):void 0,n=(l=a.rows.next(e))?lj(a.cells,d,l):void 0,p=(l=a.cols.Ac(d))?lj(a.cells,l,e):void 0;l=(l=a.cols.next(d))?lj(a.cells,l,e):void 0;var q=a.rows.first(),r=e===q;q=a.rows.last();q=e===q;e=a.cols.first();e=d===e;var t=
a.cols.last();d=d===t;var u=bCb(a,m,c);t=cCb(a,b,c);var w;h=h?!r&&u&&t?i6(u,[...(null!==(w=null===m||void 0===m?void 0:m.span.columns)&&void 0!==w?w:[])].map(C=>a.Jq(C)),t,[...b.span.columns].map(C=>a.Jq(C))):null===t||void 0===t?void 0:t.borderStyle:void 0;w=bCb(a,b,c);m=cCb(a,n,c);var x;k=k?!q&&w&&m?i6(w,[...b.span.columns].map(C=>a.Jq(C)),m,[...(null!==(x=null===n||void 0===n?void 0:n.span.columns)&&void 0!==x?x:[])].map(C=>a.Jq(C))):null===w||void 0===w?void 0:w.borderStyle:void 0;w=dCb(a,p,c);
x=eCb(a,b,c);var z;f=f?!e&&w&&x?i6(w,[...(null!==(z=null===p||void 0===p?void 0:p.span.rows)&&void 0!==z?z:[])].map(C=>a.Kr(C)),x,[...b.span.rows].map(C=>a.Kr(C))):null===x||void 0===x?void 0:x.borderStyle:void 0;z=dCb(a,b,c);c=eCb(a,l,c);var B;c=g?!d&&z&&c?i6(z,[...b.span.rows].map(C=>a.Kr(C)),c,[...(null!==(B=null===l||void 0===l?void 0:l.span.rows)&&void 0!==B?B:[])].map(C=>a.Kr(C))):null===z||void 0===z?void 0:z.borderStyle:void 0;return{ra:h,Ea:k,qa:f,Ja:c}}}},f6=function(a){return null==a||
"inherit"===a?void 0:a},g6=function(a){return null==a||"inherit"===a?void 0:Number(a.split("px")[0])},h6=function(a){return null==a||"inherit"===a?void 0:a.split(" ").map(b=>{b=Number(b);return 0<b?b:void 0}).filter(__c.ub)},hCb=function(a){const b={transform:"translate(-1000px, -1000px) scale(0)"},c={fta:b,GD:b,Ba:{},CS:{}},d=j6(()=>({style:a.mY.style||c,fV:a.fV}),({style:f,fV:g})=>{var h;Object.assign(a.Aca.style,f.fta);Object.assign(a.gM.style,f.GD);Object.assign(a.HD.style,f.Ba);Object.assign(a.HA.style,
f.CS);({textDecoration:f}=(null===(h=a.mY.style)||void 0===h?void 0:h.Ba)||{});a.HD.classList.toggle("OQx3PQ","underline"===f);a.HD.classList.toggle("_99ezUA","line-through"===f);a.HD.classList.toggle("kppAqQ","underline line-through"===f);a.HD.style.display=g?"none":"unset"},{fireImmediately:!0,equals:k6.structural}),e=j6(()=>a.fV?void 0:a.renderer,f=>{a.$0&&"react"!==(null===f||void 0===f?void 0:f.type)?(a.$0=void 0,a.PW.remove()):a.HA.innerHTML="";switch(null===f||void 0===f?void 0:f.type){case "react":a.$0=
gCb(f.node,a.PW);a.HA.appendChild(a.PW);break;case "dom":f.render(a.HA);break;case void 0:break;default:throw new D(f);}a.gW()},{fireImmediately:!0});return()=>{d();e()}},jCb=function(a){const b=a.Aw,c=a.EG,d=new iCb(a.MX);return e=>T5(l6,{...e,EG:c,Aw:b,hha:d})},kCb=class{equals(a){return this.type===a.type&&this.sheet===a.sheet&&this.container.equals(a.container)}constructor(a,b){this.container=a;this.sheet=b;this.type="sheet-item"}},lCb=class{get sheet(){return this.container.sheet}equals(a){return this.type===
a.type&&this.xa===a.xa&&this.column===a.column&&this.container.equals(a.container)}constructor(a,b,c){this.container=a;this.column=b;this.xa=c;this.type="sheet-item-cell";this.content=A(lj(a.sheet.config.cells,b,c)).content}},mCb=class{get items(){return this.text.items}equals(a){return this.type===a.type&&this.text===a.text&&this.container.equals(a.container)}constructor(a,b){P(this,{items:__c.S});this.container=a;this.text=b;this.type="sheet-item-cell-richtext"}},CBb=({ih:a,wR:b})=>c=>(0,__c.N)(__c.ebb,
{...c,ih:a,wR:b}),m6=__webpack_require__(443763),T5=m6.jsx,n6=m6.jsxs,o6=m6.Fragment;var X5=__webpack_require__(736241).Pi;var p6=__webpack_require__(875604),q6=p6.Component,PBb=p6.PureComponent,W5=p6.useMemo,nCb=p6.useState,Y5=p6.useCallback,oCb=p6.createRef;var r6=__webpack_require__(42782),c6=r6.Fl,k6=r6.p6,s6=r6.LO,t6=r6.aD,u6=r6.EH,j6=r6.U5;var v6=__webpack_require__(240236).gn;var pCb=__webpack_require__,qCb=pCb(993864),V5=pCb.n_x(qCb)();var rCb=__webpack_require__(358579).Z;var w6=__webpack_require__(649799),x6=w6.Om,y6=w6.YN,sCb=w6.kq;var gCb=__webpack_require__(204358).createPortal;var tCb=X5(a=>{var b,c,d="rtl"===a.sheet.direction;d={H2wykw:!d,UweldA:d};const [e]=nCb(()=>xt()),f={get:Y5(()=>{var g;const h=null===e||void 0===e?void 0:null===(g=e.current)||void 0===g?void 0:g.getBoundingClientRect();var k,l;g={top:0,left:0,width:null!==(k=null===h||void 0===h?void 0:h.width)&&void 0!==k?k:0,height:null!==(l=null===h||void 0===h?void 0:h.height)&&void 0!==l?l:0};return __c.gs(g)},[e])};return n6("div",{className:V5("nMvVqA",d),children:[n6("div",{ref:rCb(a.Td,e),className:"_0YOFPg",
children:[T5(a.tq,{...a,viewport:f}),T5("div",{className:V5("Gdl7fQ",d),children:null===(c=a.uqa)||void 0===c?void 0:null===(b=c.get())||void 0===b?void 0:b.map((g,h)=>T5(g,{},h))})]}),"visible"===a.Imb&&n6(o6,{children:[T5("div",{className:V5("_32sKQw",d),children:T5(a.mNa,{...a})}),T5("div",{className:V5("xdIsTQ",d),children:T5(a.qNa,{...a})}),T5("div",{className:V5("rsTRSA",d),children:T5(a.oNa,{...a})})]})]})}),uCb=X5(a=>{a=a.content;__c.v("text2"===a.type||"text3"===a.type);switch(a.type){case "text2":return T5(o6,
{children:a.value.aa});case "text3":return T5(o6,{children:__c.bq.ya(a.value).cells.aa()});default:throw new D(a);}});var BBb=yBb((a,b)=>{const c=a.value;({Qi:a}=Md(__c.$d,a.context.attrs));const d=document.createElement("div");"wrap"===a&&(d.className="dt4Dlg",d.style.overflowWrap="break-word");d.innerText=c;b.appendChild(d)});var DBb=a=>yBb((b,c)=>{const d=b.content;b=b.context;if(d.value.isEmpty)for(;c.lastChild;)c.lastChild.remove();else({Qi:b}=Md(__c.$d,b.attrs)),"wrap"===b&&(c=c.appendChild(document.createElement("div")),c.className="dt4Dlg"),a.render({container:c,text:d.value,Ga:void 0,writingMode:1,zd:"start",Cf:vCb(d,b)})}),vCb=x6((a,b)=>{if("wrap"===b)return[];a=a.value.aa.split("\n").map(c=>c.length+1);a.pop();return a},{equals:k6.structural});var U5=class a extends q6{static A(b){P(b,{Qi:c6})}get Qi(){return Md(__c.$d,this.props.context.attrs).Qi}render(){var b=this.props.content;const c=this.props.context;if(b.value.isEmpty)return null;b=T5(this.props.Tj,{content:b,xa:c.xa,col:c.col,Qi:this.Qi},this.key++);return"wrap"===this.Qi?T5("div",{className:"dt4Dlg",children:b}):T5(o6,{children:b})}constructor(...b){super(...b);a.A(this);this.key=0}};U5=v6([Nc],U5);var wCb=4*__c.Zu,xCb=3*__c.Zu;var JBb=class{Xm(a,b){return"large"===b?wCb*a:xCb*a}constructor(){this.xZa=x6((a,b)=>{var c,d;b=b.get();return null!=b&&a.layout.rows.count()===((null===(c=b.rows)||void 0===c?void 0:c.size)||0)&&a.layout.cols.count()===((null===(d=b.columns)||void 0===d?void 0:d.size)||0)});this.mGa=sCb(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.columns)||[])},{equals:__c.Kh});this.oGa=sCb(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.rows)||[])},{equals:__c.Kh});this.FXa=
x6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.mGa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of FBb(c?c.span.Lc:e.column,c?c.span.Vd:e.column,a.layout.cols))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Kh});this.GXa=x6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.oGa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of FBb(c?c.span.Pc:e.xa,c?c.span.re:
e.xa,a.layout.rows))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Kh})}};var Z5=class a extends q6{static A(b){P(b,{$c:c6,Do:c6,Ana:c6})}get $c(){return"rtl"===this.props.sheet.direction}get Do(){var b;const c=null===(b=this.props.qv)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.mE(c)}get Ana(){var b,c,d;return null===(c=(d=this.props).AWa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return T5(__c.kv,{ho:"light",light:"light",Iq:"light",dark:"light",children:this.RQa})}constructor(...b){super(...b);a.A(this);this.onMouseMove=
t6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"column",f)});this.onMouseLeave=t6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.c5a=()=>{const {sheet:c,eHa:d,tza:e,Xm:f,scale:g=1}=this.props;let h=-1;return T5("div",{style:void 0,className:V5("Vt2_4w",{jNbTIg:!this.$c,gtA7Dw:this.$c},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:c.cols.map(k=>{h++;return T5(yCb,{col:k,label:__c.jY(h),
bna:d,rr:e,Xm:f,scale:g},k.id)})})};this.RQa=c=>{var d;const e={jNbTIg:!this.$c,gtA7Dw:this.$c};return n6("div",{ref:null===(d=this.Do)||void 0===d?void 0:d.Xf,className:V5("xhBZaw",e,c.className),children:[void 0,this.c5a()]})}}};Z5=v6([Nc],Z5);
var $5=class a extends q6{static A(b){P(b,{$c:c6,Do:c6,Ana:c6})}get $c(){return"rtl"===this.props.sheet.direction}get Do(){var b;const c=null===(b=this.props.qv)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.mE(c)}get Ana(){var b,c,d;return null===(c=(d=this.props).AWa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return T5(__c.kv,{ho:"light",light:"light",Iq:"light",dark:"light",children:this.L5a})}constructor(...b){super(...b);a.A(this);this.onMouseMove=
t6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"row",f)});this.onMouseLeave=t6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.k5a=()=>{const {sheet:c,fHa:d,Pza:e,Xm:f,scale:g=1}=this.props;let h=-1;return T5("div",{style:void 0,className:V5("_93roJg",{jNbTIg:!this.$c,gtA7Dw:this.$c},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:c.rows.map(k=>{h++;return T5(zCb,{xa:k,label:`${h+
1}`,bna:d,rr:e,Xm:f,scale:g},k.id)})})};this.L5a=c=>{var d;const e={jNbTIg:!this.$c,gtA7Dw:this.$c};return n6("div",{ref:null===(d=this.Do)||void 0===d?void 0:d.Xf,className:V5("An9VeA",e,c.className),children:[void 0,this.k5a()]})}}};$5=v6([Nc],$5);
var yCb=X5(a=>{const {label:b,col:c,bna:d,rr:e,Xm:f,scale:g=1}=a;a=f(g);const h=y6(()=>d(c)),k=y6(()=>e(c));return T5("div",{className:V5("_83Rssw","d2uLIA",{YbLr8g:h,sTqdww:k}),style:{width:c.width*g,height:a},children:T5(GBb,{label:b,width:c.width,height:f(1),scale:g,highlight:h,selected:k})})}),zCb=X5(a=>{const {label:b,xa:c,bna:d,rr:e,Xm:f,scale:g=1}=a;a=f(g);const h=y6(()=>d(c)),k=y6(()=>e(c));return T5("div",{className:V5("_83Rssw","JhBzyw",{YbLr8g:h,sTqdww:k}),style:{width:a,height:c.height*
g},children:T5(GBb,{label:b,width:f(1),height:c.height,scale:g,highlight:h,selected:k})})});var ACb='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="6" cy="6" r="5.5"/></svg>';var BCb='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="12" cy="12" r="9.25" stroke-width="1.5"/></svg>';var HBb=__c.LT({Bm:ACb,medium:BCb});var a6=class a extends q6{static A(b){P(b,{ad:c6.struct})}constructor(...b){super(...b);a.A(this)}render(){return T5(this.props.tq,{sheet:this.props.element.config,qv:this.props.qv,oy:this.props.oy,yy:this.props.yy,scaleFactor:this.props.scaleFactor,ad:this.ad,Tj:this.props.Tj,KG:void 0,uR:void 0})}get ad(){const b=this.props.Hd,c=this.props.element.altText;return c?c.Kd&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}};a6=v6([Nc],a6);var CCb=class{constructor(){this.n8=new WeakMap;this.XWa=a=>this.n8.get(a);this.NGa=(a,b)=>{this.n8.set(a,b)};this.AQa=(a,b)=>{const c=this.n8.get(a);c&&c.Eb===b.Eb&&c.Ub===b.Ub&&c.Cg===b.Cg&&this.n8.delete(a)}}};var ECb=X5(a=>{const b=a.Eb,c=a.item,d=a.Cg,e=a.Ub,f=a.Rd,g=a.col,h=a.xa,k=a.content,l=a.Qi;a=a.aP;__c.v("text3"===k.type);__c.LI(a,__c.bq.ya(k.value),(p,q)=>__c.bq.domain.Kb(p,q));[a]=nCb(()=>new DCb(c,e,c6(()=>b.zoom)));const m=W5(()=>new kCb(d,c),[d,c]),n=W5(()=>{var p=new lCb(m,g,h);return new mCb(p,k.value)},[m,g,h,k.value]);return T5(f,{Eb:b,gg:n,text:k.value,Ub:a,Cf:"wrap"===l?"pre-wrap":"nowrap"})}),DCb=class extends __c.qT{static A(a){P(a,{width:s6.ref,oZ:c6})}get BA(){return this.m8.BA}get oZ(){const a=
(this.Lha.width-this.m8.width)/2;return{left:-a,right:this.m8.width+a}}constructor(a,b,c){super();DCb.A(this);this.sheet=a;this.m8=b;this.zoom=c;this.width=0;this.marginWidth=void 0;this.Lha=new __c.Aw(this.sheet,this.m8,{zoom:this.zoom.get()})}};var z6=parseInt("4px",10)||4,FCb=X5(({sheet:a,scale:b,range:c,Ys:d,Zs:e})=>{if(null!=c&&(d||e)){if(d&&e)return d=a.ra(c.re)+c.re.height,a=a.qa(c.Vd)+c.Vd.width,T5("div",{style:{top:d*b,width:a*b,height:z6*b},className:V5("aX8dhQ","VGcLng")});if(d)return c=a.qa(c.Vd)+c.Vd.width,T5("div",{style:{left:c*b,width:z6*b,height:a.height*b},className:V5("aX8dhQ","gl1RPg")});if(e)return c=a.ra(c.re)+c.re.height,T5("div",{style:{top:c*b,width:a.width*b,height:z6*b},className:V5("aX8dhQ","VGcLng")})}});var NBb=X5(({sheet:a,children:b,LF:c})=>{const d=Y5(f=>{c.Nma(a,f)},[c,a]),e=Y5(f=>{null!=f?c.NF.set(a,f):c.NF.delete(a)},[c,a]);return T5(__c.Eab,{direction:"rtl"===a.config.direction?"rtl":"ltr",onScroll:d,Ut:e,children:b})}),MBb=class{Nma(a,b){this.onScroll&&this.onScroll(a);this.wX.set(a,b)}constructor(a){this.onScroll=a;this.NF=new WeakMap;this.wX=s6.map(new Map,{deep:!1});this.scrollTo=t6((b,c)=>{b=this.NF.get(b);null===b||void 0===b?void 0:b.scrollTo({left:Math.floor(c)})})}};var b6=class a extends q6{static A(b){P(b,{ad:c6.struct})}render(){const b=this.props.item;return T5("div",{ref:this.props.measureRef,className:"E8r86A",style:{width:Math.min(this.props.Ub.width,b.G)},children:T5(this.props.JG,{sheet:b,children:T5("div",{ref:this.props.tYa,className:"cXTiJA",style:{width:b.G,height:b.N},children:T5(this.props.tq,{sheet:b.config,qv:this.props.qv,scaleFactor:this.props.scaleFactor,oy:this.props.oy,yy:this.props.yy,ad:this.ad,Tj:this.Tj,KG:this.KG,uR:void 0})})})})}get ad(){const b=
this.props.Hd,c=this.props.item.altText;return c?c.Kd&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}constructor(...b){super(...b);a.A(this);this.Tj=X5(c=>T5("div",{className:"wKvivQ",children:T5(ECb,{...this.props,...c,Rd:this.props.Rd})}));this.KG=({sheet:c,range:d,Ys:e,Zs:f})=>T5(FCb,{sheet:c,scale:1,range:d,Ys:e,Zs:f})}};b6=v6([Nc],b6);var GCb=X5(({page:a,range:b,dqa:c})=>{if(null!=c){var d=RBb(a.sheet,b);return T5("div",{className:"Gi9pfA",children:a.elements.map((e,f)=>null==d?T5(c,{element:e},f):__c.es(__c.gs(e)).Ko(d)&&T5(c,{element:e},f))})}});var HCb=new __c.DY,A6=a=>wCb*a,B6=()=>!1,SBb=X5(({page:a,qv:b,oy:c,yy:d,m3:e,scaleFactor:f,viewport:g,X6a:h,tq:k,Tj:l,dqa:m,pcb:n,ocb:p})=>{var q="rtl"===a.sheet.direction,r;const t=null!==(r=null===f||void 0===f?void 0:f.get())&&void 0!==r?r:1;r=W5(()=>({range:w})=>n6(o6,{children:[m&&T5(GCb,{page:a,dqa:m,range:w}),p&&T5(p,{})]}),[a,m,p]);const u=W5(()=>X5(({sheet:w,range:x,Ys:z,Zs:B})=>{if(null!=x){var C,F=null!==(C=null===f||void 0===f?void 0:f.get())&&void 0!==C?C:1;return n6(o6,{children:[n&&
T5(n,{range:x}),T5(FCb,{sheet:w,scale:F,range:x,Ys:z,Zs:B})]})}}),[n,f]);b=T5(k,{sheet:a.sheet,qv:b,oy:c,yy:d,m3:e,scaleFactor:f,viewport:g,Tj:l,KG:u,uR:r});q=n6("div",{className:"OsKKIQ",children:[T5("div",{className:"VDFv_A",children:b}),T5("div",{className:"_688KWg",children:T5(IBb,{$c:q,highlight:!1,Xm:A6,scale:t})}),T5("div",{className:"m0cT1w",children:T5(Z5,{sheet:a.sheet,scale:t,Xm:A6,tza:B6,eHa:B6,YO:HCb})}),T5("div",{className:"zm537g",children:T5($5,{sheet:a.sheet,scale:t,Xm:A6,Pza:B6,
fHa:B6,YO:HCb})})]});return h?q:b});var iCb=class{constructor(a){this.MX=a;this.nQa=__c.hW;this.CWa=x6((b,c,d,e)=>{const f=[];e=this.KWa(b,c,d,e);c=(l,m)=>(l=__c.kj(b.cells,m,l))&&__c.pta(l);for(const {xa:l,column:m,textAlign:n,nRa:p}of e){var g=p.width+("center"===n?0:this.nQa),h=void 0;switch(n){case "start":case "justify":e=b.qa(m);h=e+g;break;case "center":h=b.qa(m)+m.width/2;e=h-g/2;h+=g/2;break;case "end":h=b.qa(m)+m.width;e=h-g;break;default:throw new D(n);}for(g=d.indexOf(m)-1;0<=g;g--){var k=d[g];if(k!==m&&!c(l,k)||!UBb(e,
h,b.qa(k)+k.width))break;f.push({xa:l,column:k,edge:"inlineEnd"})}for(g=d.indexOf(m)+1;g<d.length;g++){k=d[g];if(k!==m&&!c(l,k)||!UBb(e,h,b.qa(k)))break;f.push({xa:l,column:k,edge:"inlineStart"})}}return f},{equals:k6.structural});this.KWa=x6((b,c,d,e)=>{const f=[];for(const h of d)for(const k of c){var g;d=b.layout.cells.get(k,h);if(!d||!d.ref.content.ref||d.span.Pc!==d.span.re||d.span.Lc!==d.span.Vd)continue;const {Qi:l,textAlign:m}=Md(__c.$d,b.layout.attrs.get(ae({Qi:void 0,textAlign:void 0}),
k,h)||{}),n=this.MX.uy(b,k,h);d=__c.pI(m,d.ref.content.ref.type,null===(g=d.ref.Ha.ref)||void 0===g?void 0:g.type,n?()=>n.bv.type:void 0);const p=e(k,h);"overflow"===l&&p&&d&&f.push({xa:k,column:h,textAlign:d,nRa:p})}return f},{equals:k6.structural})}};var d6=(a,b)=>`${a.column.id}-${a.boundary}:${b.xa.id}-${b.boundary}`,JCb=class{constructor(){this.oK=ICb;this.VQa=x6(a=>{const b=new Map;for(const {column:c,xa:d,edge:e}of a){switch(e){case "blockStart":a={ra:!0};break;case "blockEnd":a={Ea:!0};break;case "inlineStart":a={qa:!0};break;case "inlineEnd":a={Ja:!0};break;default:throw new D(e);}const f=`${c.id}:${d.id}`;b.set(f,{...b.get(f),...a})}return b});this.TWa=x6(a=>{const b=new Map;let c=0;a.rows.forEach(d=>{const e=c,f=e+d.height;b.set(d,{start:e,
end:f});c=f});return b});this.rWa=x6(a=>{const b=new Map;var c="rtl"===a.direction;const d=c?-1:1;let e=0;c&&(c=a.cols.last(),e=null!=c?a.qa(c)+c.width:0);a.cols.forEach(f=>{const g=e,h=g+f.width*d;b.set(f,{start:g,end:h});e=h});return b})}},KCb=class{constructor(){this.z5a=x6((a,b)=>{const c=new Map;for(const d of a.rows)for(const e of a.cols){const f=`${e.id}:${d.id}`,g=fCb(a,{column:e,xa:d},b);g&&c.set(f,g)}return c},{equals:k6.identity});this.FRa=x6(a=>{const b=new Map;for(const d of a.cols)for(const e of a.rows){var c=
e6(this,a,d,e);if(!c)continue;const f=c.qa,g=c.Ja,h=c.ra;c=c.Ea;f&&b.set(f.color,(b.get(f.color)||0)+1);h&&b.set(h.color,(b.get(h.color)||0)+1);g&&d===a.cols.last()&&b.set(g.color,(b.get(g.color)||0)+1);c&&e===a.rows.last()&&b.set(c.color,(b.get(c.color)||0)+1)}return b},{equals:k6.identity})}},ICb=new KCb,$Bb=new JCb;var C6=class a extends q6{static A(b){P(b,{lna:c6({equals:k6.shallow}),mna:c6({equals:k6.shallow}),pza:c6({equals:k6.structural})})}componentDidMount(){const b=A(this.ref.current);zc(this,u6(()=>{var c=this.props.scaleFactor;const d=this.props.sheet;var e;c=null!==(e=null===c||void 0===c?void 0:c.get())&&void 0!==e?e:1;e=d.height;b.style.width=`${d.width*c}px`;b.style.height=`${e*c}px`}))}get lna(){const b=this.props.sheet;return[...this.props.R9a].sort((c,d)=>b.cols.Pl(c,d))}get mna(){const b=this.props.sheet;
return[...this.props.Vw].sort((c,d)=>b.rows.Pl(c,d))}get pza(){return this.props.hha.CWa(this.props.sheet,this.mna,this.lna,this.props.kU)}render(){var b=this.props.sheet;const c=aCb(b,this.mna,this.lna,this.pza),d=b.width,e=b.height;b="rtl"===b.direction;return T5("svg",{ref:this.ref,role:"presentation",className:V5("c6a1eQ",{H_CtIQ:!b,_8_56PQ:b}),viewBox:`0 0 ${d} ${e}`,strokeLinecap:"butt",strokeLinejoin:"miter",children:c.map(({lines:f,color:g,weight:h,Si:k,Ti:l})=>T5("path",{stroke:g,strokeDasharray:k,
strokeDashoffset:l,strokeWidth:h,d:f.map(({p1:m,p2:n})=>`M ${m.x} ${m.y} L ${n.x} ${n.y}`).join(" ")},`${g}-${h}-${k}-${l}`))})}constructor(...b){super(...b);a.A(this);this.ref=oCb()}};C6=v6([Nc],C6);var E6=class a extends q6{static A(b){P(b,{w2:c6,TJa:c6})}render(){var b;const c=this.props.$Va;return n6("div",{ref:this.ZGa,className:V5("ZTz_iA","ltr"===this.props.sheet.direction?"TA4X7w":"WvuqMw"),children:[(null===c||void 0===c?void 0:c.APa)&&T5(D6,{...this.props,range:c.APa.range,Ys:!0,Zs:!0,className:"_0C8M3w",v0:this.w2}),(null===c||void 0===c?void 0:c.F9a)&&T5(D6,{...this.props,range:c.F9a.range,Ys:!1,Zs:!0,className:"_7n44yg",v0:this.w2}),(null===c||void 0===c?void 0:c.HXa)&&T5(D6,{...this.props,
range:c.HXa.range,Ys:!0,Zs:!1,className:"fF5r6w",v0:this.w2}),T5(D6,{...this.props,range:null===c||void 0===c?void 0:null===(b=c.c9a)||void 0===b?void 0:b.range,Ys:!1,Zs:!1,className:"llILYw",v0:this.TJa})]})}componentDidMount(){const b=u6(()=>{var c=this.props,d=c.scaleFactor;c=c.sheet;const e=this.ZGa.current;e&&(d=d?d.get():1,e.style.width=`${c.width*d}px`,e.style.height=`${c.height*d}px`)});zc(this,[b])}get w2(){return{type:"excluded"}}get TJa(){return{type:"hidden",bM:this.ZPa}}constructor(...b){super(...b);
a.A(this);this.ZGa=xt();this.ZPa=(c,d)=>{var e;const f=this.props.sheet;var g=this.props.$Va;g=null===g||void 0===g?void 0:null===(e=g.c9a)||void 0===e?void 0:e.range;return null==g?!0:0<=f.cols.Pl(c,g.Lc)&&0>=f.cols.Pl(c,g.Vd)&&0<=f.rows.Pl(d,g.Pc)&&0>=f.rows.Pl(d,g.re)}}};E6=v6([Nc],E6);
var D6=class a extends q6{static A(b){P(b,{XGa:c6})}get XGa(){const b=this.props.viewport,c=this.props.Ys,d=this.props.Zs;return null==b||!c&&!d?b:c6(()=>{const e=__c.os(b.get());return __c.gs({top:d?0:e.top,left:c?0:e.left,width:e.width,height:e.height})})}render(){const b=this.props.sheet,c=this.props.range,d=this.props.v0,e=this.props.KG,f=this.props.uR,g=this.props.Ys,h=this.props.Zs,k="ltr"===b.direction?"TA4X7w":"WvuqMw";return T5("div",{ref:this.Eka,className:V5("i0YQww",this.props.className),
children:n6("div",{ref:this.MDa,children:[n6("div",{ref:this.LDa,className:"vUKoKg",children:[T5(F6,{...this.props,viewport:this.XGa,bounds:"hidden"===(null===d||void 0===d?void 0:d.type)?void 0:c,bM:"hidden"===(null===d||void 0===d?void 0:d.type)?d.bM:void 0}),T5("div",{className:V5("DC3n2A",k),children:f&&T5(f,{range:c})})]}),T5("div",{className:V5("DC3n2A",k),children:e&&T5(e,{sheet:b,range:c,Ys:g,Zs:h})})]})})}componentDidMount(){const b=u6(()=>{var h=this.props,k=h.scaleFactor,l=h.sheet;const m=
h.range;var n=this.Eka.current;const p=this.LDa.current;h=this.MDa.current;k=k?k.get():1;const q=m?l.qa(m.Vd)+m.Vd.width-l.qa(m.Lc):l.width,r=m?l.ra(m.re)+m.re.height-l.ra(m.Pc):l.height;n&&(n.style.width=`${q*k}px`,n.style.height=`${r*k}px`);p&&(p.style.width=`${q*k}px`,p.style.height=`${r*k}px`);h&&(n="rtl"===l.direction,n=m?l.qa(m.Lc)*k*(n?1:-1):0,l=m?-l.ra(m.Pc)*k:0,h.style.transform=`translate(${n}px, ${l}px)`)}),c=this.props.sheet;var d=this.props.m3;const e=this.props.Ys,f=this.props.Zs,g=
null===d||void 0===d?void 0:d(c,e,f);d=u6(()=>{const h=this.Eka.current;if(null!=h){var k=e||f?"sticky":"relative",l=f?"0px":"unset",m=e?"0px":"unset",n=e?"0px":"unset",p="rtl"===c.direction;if(null==g)h.style.position=k,h.style.top=l,h.style.left=p?"unset":m,h.style.right=p?n:"unset";else{const x=g.get();var q;h.style.position=null!==(q=x.position)&&void 0!==q?q:k;var r;h.style.top=null!==(r=x.top)&&void 0!==r?r:l;var t;h.style.left=p?"unset":null!==(t=x.left)&&void 0!==t?t:m;var u;h.style.right=
p?null!==(u=x.right)&&void 0!==u?u:n:"unset";var w;h.style.transform=null!==(w=x.transform)&&void 0!==w?w:"unset"}}});zc(this,[b,d])}constructor(...b){super(...b);a.A(this);this.Eka=xt();this.MDa=xt();this.LDa=xt()}};D6=v6([Nc],D6);
var LCb=class{constructor(){this.DS=new Map;this.j$a=(a,b,c,d)=>{const e=new LCb;for(const [f,g]of this.DS)c.has(g.xa)&&e.DS.set(f,g);c=`${b.id}:${a.id}`;d?e.DS.set(c,{width:d.width,height:d.height,xa:a,column:b}):e.DS.delete(c);return e};this.kU=(a,b)=>this.DS.get(`${b.id}:${a.id}`)}},F6=class a extends q6{static A(b){P(b,{cL:s6.shallow,Do:c6,bounds:c6,Vw:c6({equals:k6.shallow}),kpa:c6({equals:k6.shallow}),gsa:t6,l1:t6.bound})}get Do(){var b;const c=null===(b=this.props.qv)||void 0===b?void 0:b.get();
if(null!=c&&0!==c.length)return new __c.mE(c)}render(){var b;return n6("div",{ref:rCb(this.Td,null===(b=this.Do)||void 0===b?void 0:b.Xf),children:[T5("div",{ref:this.gta,className:"_5YlOqQ"}),T5("div",{ref:this.pta,className:"_XCmKw"}),this.cL.map(c=>c.$3a),T5(this.eaa,{kU:this.state.kU})]})}componentDidMount(){const b=j6(()=>[this.kpa,this.Vw],([e,f])=>this.gsa(e,f),{fireImmediately:!0}),c=u6(()=>{var e=this.props,f=e.scaleFactor;e=e.sheet;const g=this.Td.current;g&&(f=f?f.get():1,g.style.width=
`${e.width*f}px`,g.style.height=`${e.height*f}px`)}),d=this.cL.map(e=>hCb(e));zc(this,[c,b,...d])}get bounds(){const b=this.props.sheet,c=this.props.bounds;var d,e,f,g;return{Lc:null!==(d=null===c||void 0===c?void 0:c.Lc)&&void 0!==d?d:b.cols.first(),Vd:null!==(e=null===c||void 0===c?void 0:c.Vd)&&void 0!==e?e:b.cols.last(),Pc:null!==(f=null===c||void 0===c?void 0:c.Pc)&&void 0!==f?f:b.rows.first(),re:null!==(g=null===c||void 0===c?void 0:c.re)&&void 0!==g?g:b.rows.last()}}get Vw(){const b=this.bounds,
c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=500*e,g=null===d||void 0===d?void 0:d.get();d=g?g.tl.y-f:b.Pc?c.ra(b.Pc):0;f=g?g.br.y+f:b.re?c.ra(b.re)+b.re.height:0;g=new Map;for(let h=b.Pc;null!=h&&null!=b.re&&0>=c.rows.Pl(h,b.re);h=c.rows.next(h)){const k=c.ra(h);if(!(k+h.height<d)){if(k>f)break;g.set(h,k*e)}}return g}get kpa(){const b=this.bounds,c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=100*e,g=null===d||void 0===
d?void 0:d.get();d=g?g.tl.x-f:b.Lc?c.qa(b.Lc):0;f=g?g.br.x+f:b.Vd?c.qa(b.Vd)+b.Vd.width:0;g=new Map;for(let h=b.Lc;null!=h&&null!=b.Vd&&0>=c.cols.Pl(h,b.Vd);h=c.cols.next(h)){const k=c.qa(h);if(!(k+h.width<d)){if(k>f)break;g.set(h,k*e)}}return g}gsa(b,c){const d=A(this.gta.current),e=A(this.pta.current),f=[],g=new Map;for(const h of this.PKa)c.has(h.xa)?g.set(h.xa,h):f.push(h);for(const [h,k]of c)c=g.get(h)||f.pop(),c||(c=new MCb(this.l1,h),d.appendChild(c.s0),e.appendChild(c.u0),this.PKa.push(c)),
c.update(k,h,b);for(const h of f)h.hide()}l1(b,c){const d=this.props.wda,e=this.props.sheet,f=this.props.bM;b=new NCb(this.props.EG,this.props.Tj,d(b,c),e,b,c,f,this.gW);zc(this,hCb(b));this.cL.push(b);return b}constructor(b){super(b);a.A(this);this.Td=xt();this.gta=xt();this.pta=xt();this.PKa=[];this.cL=[];this.eaa=X5(c=>{const d=[...this.Vw.keys()],e=[...this.kpa.keys()];return T5(this.props.lNa,{Vw:d,R9a:e,kU:c.kU})});this.gW=(c,d,e)=>{this.setState(f=>{const g=e();return f.j$a(d,c,this.Vw,g)})};
this.state=new LCb}};F6=v6([Nc],F6);
var MCb=class{static A(a){P(a,{update:t6})}update(a,b,c){[this.s0,this.u0].forEach(d=>{d.style.transform=`translateY(${a}px)`;d.classList.add("FPpqvg")});this.xa=b;for(const [d]of c)c=this.cL.get(d),c||(c=this.l1(d,b),this.cL.set(d,c),this.s0.appendChild(c.Aca),this.u0.appendChild(c.gM)),c.update(b)}hide(){[this.s0,this.u0].forEach(a=>{a.style.transform="translate(-1000px, -1000px) scale(0)"})}constructor(a,b){MCb.A(this);this.l1=a;this.xa=b;this.s0=document.createElement("div");this.u0=document.createElement("div");
this.cL=new Map}},NCb=class{static A(a){P(a,{$0:s6.ref,xa:s6.ref,Ba:c6,attrs:c6,fV:c6,renderer:c6,update:t6})}get $3a(){return this.$0}get Ba(){return __c.kj(this.sheet.cells,this.col,this.xa)}get attrs(){return this.sheet.layout.attrs.get(ae({Qi:0,textAlign:0,direction:0}),this.xa,this.col)||{}}get fV(){return this.bM?!this.bM(this.col,this.xa):!1}get renderer(){const a=this.Ba;if(a&&(a.content||a.Ha))return this.EG({context:{xa:this.xa,col:this.col,sheet:this.sheet,attrs:this.attrs},aP:this.gW,
Tj:this.Tj})}update(a){this.xa=a;this.mY.xa=a}constructor(a,b,c,d,e,f,g,h){NCb.A(this);var k,l,m,n,p,q;this.EG=a;this.mY=c;this.sheet=d;this.col=e;this.bM=g;this.Aca=document.createElement("div");this.gM=document.createElement("div");this.HD=document.createElement("div");this.HA=document.createElement("div");this.PW=document.createElement("div");this.e0a=()=>{if(this.renderer){var r="react"===this.renderer.type?this.PW:this.HA;if(0!==r.childNodes.length&&(r=r.childNodes[0],r instanceof HTMLElement))return{width:r.clientWidth,
height:r.clientHeight}}};this.xa=f;this.Aca.className="_2JFriw";this.gM.className="imy9ug";this.HD.className=V5("pDMp7w",{_0yZ6Qg:"text3"!==(null===(l=this.Ba)||void 0===l?void 0:null===(k=l.content)||void 0===k?void 0:k.type),qhF5uA:"text3"!==(null===(n=this.Ba)||void 0===n?void 0:null===(m=n.content)||void 0===m?void 0:m.type)&&"text2"!==(null===(q=this.Ba)||void 0===q?void 0:null===(p=q.content)||void 0===p?void 0:p.type)});this.HA.className="_30B9pw";this.HD.appendChild(this.HA);this.gM.appendChild(this.HD);
this.PW.className="G7zH2w";this.gW=()=>{h(this.col,this.xa,this.e0a)};this.Tj=r=>T5(b,{...r,aP:this.gW})}};var l6=class extends q6{render(){const a=this.props.sheet,b=this.props.qv,c=this.props.m3,d=this.props.EG,e=this.props.ad,f=this.props.Tj,g=this.props.viewport,h=this.props.KG,k=this.props.uR;return T5("div",{className:V5("SNkrHw","ltr"===a.direction?"TA4X7w":"WvuqMw"),...e,children:T5(E6,{EG:d,Tj:f,lNa:this.eaa,wda:this.wda,sheet:a,qv:b,m3:c,scaleFactor:this.scaleFactor,viewport:g,KG:h,uR:k})})}get scaleFactor(){return this.props.scaleFactor?this.props.scaleFactor:c6(()=>1)}constructor(...a){super(...a);
this.eaa=X5(b=>T5(C6,{...b,sheet:this.props.sheet,scaleFactor:this.scaleFactor,hha:this.props.hha}));this.wda=(b,c)=>new __c.wta(this.props.Aw,this.props.sheet,b,c,this.scaleFactor,this.oy,this.yy);this.oy=(b,c)=>{var d,e;return null===(d=(e=this.props).oy)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)};this.yy=(b,c)=>{var d,e;return null===(d=(e=this.props).yy)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)}}};l6=v6([Nc],l6);__c.Bta={DYa:function(a){const b=a.Ul,c=a.Gd,d=a.yc,e=a.jl,f=a.MX,g=a.Aw,h=a.HR;EBb({zw:a.zw,ih:a.ih,U7a:a.eK});const k=jCb({EG:h,MX:f,Aw:g});b.xaa=TBb({tq:k});c.faa=LBb({tq:k});({pNa:a}=QBb({tq:k,Rd:e(),WGa:new CCb}));d.Wn.waa=a;const {vLa:l,wLa:m,uLa:n}=KBb();return{Eqa:X5(p=>T5(tCb,{...p,tq:k,oNa:l,qNa:m,mNa:n,Tj:uCb}))}}};
}).call(self, self._fe4d99ebe0d2d259646a80d250150d47);}

}])
//# sourceMappingURL=sourcemaps/84826d1c3b0df13e.js.map